{"key": "sdk-node:rule", "created_at": "2023-01-31T00:00:23.375456+0000", "panther_sdk_version": "2022-08-17", "val": {"o": {"pkg": "panther_sdk.detection", "name": "panther_sdk.detection.detection.wrapper"}, "t": "Rule", "d": {"filters": [{"o": {"pkg": "panther_detections.utils", "name": "panther_detections.utils.match_filters.deep_equal"}, "t": "PythonFilter", "d": {"func": {"src": "ZGVmIF9kZWVwX2VxdWFsKGV2ZW50KToKICAgIGltcG9ydCBjb2xsZWN0aW9ucwogICAgaW1wb3J0IGZ1bmN0b29scwogICAga2V5cyA9ICdldmVudFR5cGUnLnNwbGl0KCcuJykKICAgIGFjdHVhbCA9IGZ1bmN0b29scy5yZWR1Y2UobGFtYmRhIGQsIGtleTogZC5nZXQoa2V5LCBOb25lKSBpZiBpc2luc3RhbmNlKGQsIGNvbGxlY3Rpb25zLmFiYy5NYXBwaW5nKSBlbHNlIE5vbmUsIGtleXMsIGV2ZW50KQogICAgcmV0dXJuIGJvb2woYWN0dWFsID09ICdzeXN0ZW0ubWZhLmZhY3Rvci5kZWFjdGl2YXRlJyk=", "name": "_deep_equal"}}}], "log_types": ["Okta.SystemLog"], "rule_id": "Okta.Global.MFA.Disabled", "severity": "HIGH", "alert_context": {"src": "ZGVmIGNyZWF0ZV9hbGVydF9jb250ZXh0KGV2ZW50KToKICAgICIiIlJldHVybnMgY29tbW9uIGNvbnRleHQgZm9yIE9rdGEgYWxlcnRzIiIiCiAgICByZXR1cm4geydpcHMnOiBldmVudC5nZXQoJ3BfYW55X2lwX2FkZHJlc3NlcycsIFtdKSwgJ2FjdG9yJzogZXZlbnQuZ2V0KCdhY3RvcicsICcnKSwgJ3RhcmdldCc6IGV2ZW50LmdldCgndGFyZ2V0JywgJycpLCAnY2xpZW50JzogZXZlbnQuZ2V0KCdjbGllbnQnLCAnJyl9", "name": "create_alert_context"}, "alert_grouping": null, "alert_title": {"src": "ZGVmIF90aXRsZShldmVudCk6CiAgICByZXR1cm4gZiJPa3RhIFN5c3RlbS13aWRlIE1GQSBEaXNhYmxlZCBieSBBZG1pbiBVc2VyIHtldmVudC51ZG0oJ2FjdG9yX3VzZXInKX0i", "name": "_title"}, "description": "An admin user has disabled the MFA requirement for your Okta account", "destinations": null, "enabled": null, "name": "Override Name", "reference": "https://developer.okta.com/docs/reference/api/event-types/?q=system.mfa.factor.deactivate", "reports": {"MITRE ATT&CK": ["TA0005:T1556"]}, "runbook": "Contact Admin to ensure this was sanctioned activity", "summary_attrs": ["eventType", "severity", "displayMessage", "p_any_ip_addresses"], "tags": ["Okta", "Identity & Access Management", "DataModel", "Defense Evasion:Modify Authentication Process"], "threshold": null, "unit_tests": [{"o": {"pkg": "panther_detections.providers.okta.rules", "name": "panther_detections.providers.okta.rules.admin_actions.admin_disabled_mfa"}, "t": "JSONUnitTest", "d": {"data": "{\"published\": \"2022-03-22 14:21:53.225\", \"eventType\": \"system.mfa.factor.deactivate\", \"version\": \"0\", \"severity\": \"HIGH\", \"actor\": {\"alternateId\": \"homer@springfield.gov\", \"displayName\": \"Homer Simpson\", \"id\": \"111111\", \"type\": \"User\"}, \"client\": {\"device\": \"Computer\", \"ipAddress\": \"1.1.1.1\", \"userAgent\": {\"browser\": \"CHROME\", \"os\": \"Mac OS X\", \"rawUserAgent\": \"Mozilla/5.0\"}, \"zone\": \"null\"}, \"p_log_type\": \"Okta.SystemLog\"}", "expect_match": true, "name": "MFA Disabled", "mocks": null}}, {"o": {"pkg": "panther_detections.providers.okta.rules", "name": "panther_detections.providers.okta.rules.admin_actions.admin_disabled_mfa"}, "t": "JSONUnitTest", "d": {"data": "{\"published\": \"2022-03-22 14:21:53.225\", \"eventType\": \"user.session.start\", \"version\": \"0\", \"severity\": \"INFO\", \"actor\": {\"alternateId\": \"homer@springfield.gov\", \"displayName\": \"Homer Simpson\", \"id\": \"111111\", \"type\": \"User\"}, \"client\": {\"device\": \"Computer\", \"ipAddress\": \"1.1.1.1\", \"userAgent\": {\"browser\": \"CHROME\", \"os\": \"Mac OS X\", \"rawUserAgent\": \"Mozilla/5.0\"}, \"zone\": \"null\"}, \"p_log_type\": \"Okta.SystemLog\"}", "expect_match": false, "name": "Login Event", "mocks": null}}]}}}
