{"key": "sdk-node:rule", "created_at": "2023-02-02T21:59:23.454027+0000", "panther_sdk_version": "2022-08-17", "val": {"o": {"pkg": "panther_sdk.detection", "name": "panther_sdk.detection.detection.wrapper"}, "t": "Rule", "d": {"filters": [{"o": {"pkg": "panther_detections.utils", "name": "panther_detections.utils.match_filters.deep_equal"}, "t": "PythonFilter", "d": {"func": {"src": "ZGVmIF9kZWVwX2VxdWFsKGV2ZW50KToKICAgIGltcG9ydCBjb2xsZWN0aW9ucwogICAgaW1wb3J0IGZ1bmN0b29scwogICAga2V5cyA9ICdhdHRyaWJ1dGVzLmFjdGlvbicuc3BsaXQoJy4nKQogICAgYWN0dWFsID0gZnVuY3Rvb2xzLnJlZHVjZShsYW1iZGEgZCwga2V5OiBkLmdldChrZXksIE5vbmUpIGlmIGlzaW5zdGFuY2UoZCwgY29sbGVjdGlvbnMuYWJjLk1hcHBpbmcpIGVsc2UgTm9uZSwga2V5cywgZXZlbnQpCiAgICByZXR1cm4gYm9vbChhY3R1YWwgPT0gJ3VzZXJfbG9nZ2VkX2luX2FzX3VzZXInKQ==", "name": "_deep_equal"}}}], "log_types": ["Atlassian.Audit"], "rule_id": "Atlassian.User.LoggedInAsUser", "severity": "HIGH", "alert_context": {"src": "ZGVmIGNyZWF0ZV9hbGVydF9jb250ZXh0KGV2ZW50KToKICAgICIiIlJldHVybnMgY29tbW9uIGNvbnRleHQgZm9yIEF0bGFzc2lhbiBhbGVydHMiIiIKICAgIHJldHVybiB7J1RpbWVzdGFtcCc6IGV2ZW50LmRlZXBfZ2V0KCdhdHRyaWJ1dGVzJywgJ3RpbWUnLCBkZWZhdWx0PSc8dW5rbm93bi10aW1lPicpLCAnQWN0b3InOiBldmVudC5kZWVwX2dldCgnYXR0cmlidXRlcycsICdhY3RvcicsICdlbWFpbCcsIGRlZmF1bHQ9Jzx1bmtub3duLWFjdG9yLWVtYWlsPicpLCAnSW1wZXJzb25hdGVkIHVzZXInOiBldmVudC5kZWVwX2dldCgnYXR0cmlidXRlcycsICdjb250ZXh0JywgZGVmYXVsdD1be31dKVswXS5nZXQoJ2F0dHJpYnV0ZXMnLCB7fSkuZ2V0KCdlbWFpbCcsICc8dW5rbm93bi1lbWFpbD4nKSwgJ0V2ZW50IElEJzogZXZlbnQuZ2V0KCdpZCcpfQ==", "name": "create_alert_context"}, "alert_grouping": null, "alert_title": {"src": "ZGVmIF90aXRsZShldmVudCk6CiAgICBhY3RvciA9IGV2ZW50LmRlZXBfZ2V0KCdhdHRyaWJ1dGVzJywgJ2FjdG9yJywgJ2VtYWlsJywgZGVmYXVsdD0nPHVua25vd24tZW1haWw+JykKICAgIGNvbnRleHQgPSBldmVudC5kZWVwX2dldCgnYXR0cmlidXRlcycsICdjb250ZXh0JywgZGVmYXVsdD1be31dKQogICAgaW1wZXJzb25hdGVkX3VzZXIgPSBjb250ZXh0WzBdLmdldCgnYXR0cmlidXRlcycsIHt9KS5nZXQoJ2VtYWlsJywgJzx1bmtub3duLWVtYWlsPicpCiAgICByZXR1cm4gZid7YWN0b3J9IGxvZ2dlZCBpbiBhcyB7aW1wZXJzb25hdGVkX3VzZXJ9Lic=", "name": "_title"}, "description": "Reports when an Atlassian user logs in (impersonates) another user.", "destinations": null, "enabled": null, "name": "Atlassian user logged in as user", "reference": "https://support.atlassian.com/user-management/docs/log-in-as-another-user/", "reports": null, "runbook": "Validate that the Atlassian admin did log in (impersonate) as another user.", "summary_attrs": null, "tags": ["Atlassian", "User impersonation"], "threshold": null, "unit_tests": [{"o": {"pkg": "panther_detections.providers.atlassian.rules", "name": "panther_detections.providers.atlassian.rules.user_logged_in_as_user.user_logged_in_as_user"}, "t": "JSONUnitTest", "d": {"data": "{\"attributes\": {\"action\": \"user_logged_in_as_user\", \"actor\": {\"email\": \"example.admin@example.com\", \"id\": \"1234567890abcdefghijklmn\", \"name\": \"Example Admin\"}, \"container\": [{\"attributes\": {\"siteHostName\": \"https://example.atlassian.net\", \"siteName\": \"example\"}, \"id\": \"12345678-abcd-9012-efgh-1234567890abcd\", \"links\": {\"alt\": \"https://example.atlassian.net\"}, \"type\": \"sites\"}], \"context\": [{\"attributes\": {\"accountType\": \"atlassian\", \"email\": \"example.user@example.io\", \"name\": \"example.user@example.io\"}, \"type\": \"users\"}], \"time\": \"2022-12-15T00:35:15.890Z\"}, \"id\": \"2508d209-3336-4763-89a0-aceaf1322fcf\", \"message\": {\"content\": \"Logged in as example.user@example.io\", \"format\": \"simple\"}}", "expect_match": true, "name": "MFA Disabled", "mocks": null}}, {"o": {"pkg": "panther_detections.providers.atlassian.rules", "name": "panther_detections.providers.atlassian.rules.user_logged_in_as_user.user_logged_in_as_user"}, "t": "JSONUnitTest", "d": {"data": "{\"attributes\": {\"action\": \"user_login\", \"actor\": {\"email\": \"example.admin@example.com\", \"id\": \"1234567890abcdefghijklmn\", \"name\": \"Example Admin\"}, \"container\": [{\"attributes\": {\"siteHostName\": \"https://example.atlassian.net\", \"siteName\": \"example\"}, \"id\": \"12345678-abcd-9012-efgh-1234567890abcd\", \"links\": {\"alt\": \"https://example.atlassian.net\"}, \"type\": \"sites\"}], \"context\": [{\"attributes\": {\"accountType\": \"atlassian\", \"email\": \"example.user@example.io\", \"name\": \"example.user@example.io\"}, \"type\": \"users\"}], \"time\": \"2022-12-15T00:35:15.890Z\"}, \"id\": \"2508d209-3336-4763-89a0-aceaf1322fcf\", \"message\": {\"content\": \"Logged in as example.user@example.io\", \"format\": \"simple\"}}", "expect_match": false, "name": "Login Event", "mocks": null}}]}}}
